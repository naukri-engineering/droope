/*
The MIT License (MIT)

Copyright (c) 2014 Info Edge India Ltd. (Naukri.com)

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

Version: droope_v1.0.0
Doc: http://https://github.com/naukri-engineering/droope
Demo: http://naukri-engineering.github.io/droope/
*/

var DD=function(t,e,a){function i(t,e,a,i){if(i.length){var r,n=e.height(),l=e.scrollTop(),o=n+l,s=i.position().top+e.scrollTop(),d=s+i.outerHeight();return d>=o?(r=d-n>0?d-n:0,e.scrollTop(r)):s<e.scrollTop()&&(r=s,e.scrollTop(r)),r}}function r(){return arguments.length?function(t){}:function(){}}function n(t){function e(t){return function(){var e=$(this).attr("id"),a=t[e],i=a.id;if(i)for(var r in i){{i[r]}h.chkBox?h.removeAllTags():(h.inpElm.val(""),h.inpHid.data("optGroupKey","")),h.Allflg="",h.hideDD()}a.clrCalbackfun&&h.onClearTag[e](h.obj,0,$(this))}}var a,i=h.id;if(h.clearAllInside){var r="Clear All";for(var n in h.clearAllInside)r=h.clearAllInside[n];a=$("<div>").addClass("DDclearAll").attr({id:"clrAll_"+i}).html(r)}var d=$("#"+i).find(".srchTxt");if(!h.dpLyr||!h.dpLyr.length){var c=d.attr("name");d.data({name:c});{var p;$("#"+i).find(".arw").addClass("DDarwDwn")}h.chkBox?p=$("#"+i).find(".DDsearch li"):(p=$("#"+i).find(".DDsearch"),$("#"+i).addClass("singleSelect")),d.data({id:"inp_"+i,placeholder:d.attr("placeholder")}).attr({name:"",autocomplete:"off"}),h.isSearch||d.attr("readonly","readonly"),h.outerCont.find(".frst").css({"float":"none"}),$("#hid_"+i).length||(h.inpHid=$("<input>").attr({type:"hidden",id:"hid_"+i,name:c}),p.append(h.inpHid));var f=$("<div>"),u=$("<div>"),g=$("<ul>"),v=$("#"+i),C=h.chkBox?"ChkboxEnb":"";h.dpLyr=f,u.addClass("nScroll").attr("id","ul_"+i),f.addClass("drop").attr("id","dp_"+i),g.addClass(C),u.append(g),a?f.append(a):"",f.append(u),v.append(f),$("#"+i).on("click",".DDinputWrap, .DDsearch, .arw",function(t){t.stopPropagation(),d[0].focus()}).on("mouseenter",function(){h.layerOpenStatus=h.srchBx!==!1?!0:!1}).on("mouseleave",function(){h.layerOpenStatus=!1})}if(d.on("focus",o).on("keydown",function(t){s(t,$(this))}).on("keyup",h.Fn.keyUpEv).on("blur",l),h.layerOpenStatus=h.srchBx!==!1?!0:!1,h.fillData(),h.clrId)for(var n in h.clrId)$("#"+n).on("click",e(h.clrId))}function l(t){var e=h.id;if(!h.TagSpCnt&&h.chkBox?$("#"+e).find(".tagit:last").removeClass("TagSelected"):"",h.layerOpenStatus||h.hideDD(),!h.chkBox){var a=h.inpHid,i=h.inpElm,r=h.uEscp(a.attr("opt")),n=a.attr("value"),l=h.Ary.A,o=r?l[r][n]:l?l[n]:"";i.val()?o&&i.val(o).css({color:"#444"}):(a.val(""),"none"==h.dpLyr.css("display")&&h.onChange(""),h.onDeselect&&h.onDeselect())}}function o(t){h.layerOpenStatus=h.srchBx!==!1?!0:!1,h.inpt=$(this);{var e=$(this).data("id");e.split("_")[1]}h.DDSearch=$(this).parent(".DDSearch"),d(),$("#"+e).css({color:"#444"})}function s(t,e){var a,r=h.id,n=t.keyCode||t.which,l=$("#"+r).width()-15,o=e.val().replace(/\b/g,""),s=h.dpLyr.css("display");if((13==n||38==n)&&t.preventDefault(),13==n&&"none"==s&&!h.chkBox&&h.obj.form&&h.obj.form[0].submit(),9==n||27==n?h.hideDD():"",(n>=97&&122>=n||n>=65&&90>=n||n>=48&&57>=n)&&!h.TagSpCnt&&h.chkBox&&h.tags!==!1&&(a=c(l),h.inpElm.css({width:a+"px"})),!o&&h.chkBox){var p=$("#"+r).find(".tagit:last"),f=p.data("id");h.TagCnt>0&&8==t.keyCode&&!h.TagSpCnt&&f&&f.length>0?h.Tagfocus?(h.removeTag(f,p.children(".tagTxt").html(),!0),h.Tagfocus=0):($("#"+r).find(".DDsearch").find('[data-id="'+f+'"]').addClass("TagSelected"),h.Tagfocus=1):f&&($("#"+r).find(".DDsearch").find('[data-id="'+f+'"]').removeClass("TagSelected"),h.Tagfocus=0)}var u=$("#ul_"+r),g=u.find("ul"),v=g.find("li:first-child");if(h.curActElm.length||(h.curActElm=v),40==n)if("none"==s)h.hideDD(),d();else{var C,D=h.curActElm.next();D.length&&!D.hasClass("noData")&&(C=D.hasClass("optgroup")?D.next():D,h.curActElm.removeClass("active"),C.addClass("active"),h.curActElm=C,i(h.dpLyr,g.parent(),v,h.curActElm))}else if(38==n){var m,k=h.curActElm.prev();k.length&&(m=k.hasClass("optgroup")?k.prev():k,m.length&&(h.curActElm.removeClass("active"),m.addClass("active"),h.curActElm=m,i(h.dpLyr,g.parent(),v,h.curActElm)))}}function d(){var t=h.id;$("#"+t).find(".DDwrap").addClass("brBotN"),$("#"+t).find(".drop").show(),$("#ul_"+t)[0].scrollTop=0;var e=$("#"+t).outerWidth()+"px";h.dpLyr.css({width:e}),h.max_height(),h.chkBox||h.firstHighlight()}function c(t){return t>u?u+=5:void(u+=1)}function p(t,e){if(""!==h.inpElm.val()&&u>f){if(e>u)return u-=5;u-=1}}var h=this,f=30;h.obj=t;var u=h.obj.postPlaceholder?h.obj.postPlaceholder.width:30;h.parentRefData={},h.liCntrFx=[],h.preventClickFor=t.preventClickFor||[],h.onDeselect=t.onDeselect,h.liCntr=[],h.isReset=!0,h.sortPrefix=t.sortPrefix,h.hidValue=[],h.maxTagsCount=t.maxTagsCount||999,h.pKey=a,h.tagwithOptGroup=t.tagwithOptGroup||!1,h.srchBx=t.searchBox===!1?!1:!0,h.clrId=t.clearTagId,h.tagsSorting=t.tagsSorting===!1?!1:!0,h.MrgPrfAryOrdr=t.appendTags||!1,h.onClearTag=[],h.sugHgt=t.maxHeight||300,h.clearAllInside=t.clearAllInside||!1,h.parentChkBox=t.parentChkBox||!1,h.chkBox=t.checkBox||!1,h.allChk=t.allChk||!1,h.layerOpenStatus=!1,h.tags=t.tags===!1?t.tags:!0,h.TagSpCnt=t.tagInSepContainer||!1,h.inputValReset=t.inputValReset===!1?!1:!0,h.id=t.id,h.preTxt=t.preText===!1?"":t.preText||"You have selected",h.Allflg="",h.postTxt=t.postText===!1?"":t.postText||"item(s)",h.curActElm="",h.Tagfocus=0,h.onClickLi=t.onClickReq||r(),h.onTagClk=t.onTagClick||r(),h.onTagCrt=t.onTagCreate||r(),h.outerCont=$("#"+h.id),h.inpElm=h.outerCont.find(".srchTxt"),h.TagCnt=0,h.tagTitle=t.tagTitle||!1,h.optgrpNameRef=[],h.optgrpObject={},h.onChange=t.onChange||r(),h.dataObj=t.data||t.id[h.id][0],h.pKey?(h.chkBox||(DD.Ary[h.id]={}),DD.Ary[h.id]||(DD.Ary[h.id]={}),DD.Ary[h.id][h.pKey]=h.dataObj,h.Ary=DD.Ary[h.id]):(h.Ary={},h.Ary.A=h.dataObj),h.prefillData=t.prefillData||(h.obj.id[h.id]?h.obj.id[h.id][1]:""),h.isSearch=0==t.isSearch?!1:!0,DD.lastRef.iseventBindOnDocument||($(document).on("click.dd",function(t){var e=$(t.target).parents(".ddwn");e.length||Boolean(e.attr("searchDisabled"))===!0||(e.find(".DDwrap").removeClass("brBotN"),e.find(".drop").hide())}),DD.lastRef.iseventBindOnDocument=!0);var g=function(t){return t.replace(/>/g,"&gt;").replace(/</g,"&lt;")},v=function(t){if(-1!=t.indexOf("<b>")){t=t.split("<b>");var e=t[1].split("</b>"),a=[t[0],e[0],e[1]],i=[];for(var r in a)i.push(g(a[r]));return i[0]+"<b>"+i[1]+"</b>"+i[2]}return g(t)};h.replaceTag=function(t){return-1!=t.indexOf("<")?v(t):t},h.setLi=function(t){var e=this;if($("#ul_"+t).find("li").length<e.liCntr){var a=e.appendData(e.Ary,"","",!0);e.dpLyr.find("ul").html(a[0]),e.liCntr=e.liCntrFx}},h.obj.resetPrefillValues?h.ChkBoxContr={}:h.ChkBoxContr?"":h.ChkBoxContr={};for(var C in t.clearTagId)for(var D in t.clearTagId[C])h.onClearTag[C]=t.clearTagId[C][D];h.Fn={preserveEventafterClone:function(e,a){var i,r=h.id;i=h.TagSpCnt?$("#"+h.TagSpCnt).find('[data-id="'+e+'"]'):$("#"+r).find(".DDsearch").find('[data-id="'+e+'"]'),i.on("click",".dCross",function(i){i.stopPropagation(),h.removeTag(e,$(this).find(".tagTxt").text(),a),h.max_height(),a?h.onTagClk(t,h.TagCnt):"",h.setInputText(),"block"==h.dpLyr.css("display")?$("#"+r).find(".srchTxt")[0].focus():""})},keyUpEv:function(t){var e=$(this).data("id"),a=$("#"+e).width()-15,i=(e.split("_")[1],t.keyCode||t.which),r=$(this).val().replace(/\b/g,"");if(13==i&&h.curActElm&&h.curActElm.length&&!h.curActElm.hasClass("noData")&&h.curActElm.hasClass("active")){var n=h.curActElm.children("a");if(h.chkBox){var l=n.data("id")+"_"+h.Escp(h.curActElm.attr("bindto"));n.hasClass("chkd")?h.removeTag("tg_"+l,n.html(),!0):h.CreateTags(n,l,"",h.tags)}else h.SingleSelection(n.text(),n.data("id").split("_")),h.hideDD()}8==i&&h.chkBox&&!h.TagSpCnt&&h.tags!==!1&&(r?wth=p(e,a)+"px":""!=h.inpHid.val()?wth=u+"px":wth="",h.inpElm.css({width:wth})),9!=i&&13!=i&&18!=i&&32!=i&&37!=i&&38!=i&&39!=i&&40!=i&&16!=i&&(h.Fn.initSearch(r,e,i),"none"==h.dpLyr.css("display")&&h.dpLyr.show())},initSearch:function(t,e,a){var i="";srchCntr=0,e=e.split("_")[1];var r=h.Ary;if(t){t=t.replace(/&amp;/gi,"&").replace(/[\s]+/g," ").replace(/^\s/,"");for(var n in r)for(var l in r[n])if("object"==typeof r[n][l]){var o,s="";o=r[n][l];for(var d in o)s+=h.searchData(o[d],t,e,e+"_"+d+"_"+h.eUnderScore(l),h.Escp(n));s&&(i+='<li class="optgroup">'+h.eUnderScore(l)+"</li>"+s,srchCntr++)}else $("#"+e).find(".cross").show(),i+=h.searchData(r[n][l],t,e,e+"_"+h.eUnderScore(l),h.Escp(n)),srchCntr++}else $("#"+e).find(".cross").hide(),i=h.appendData(h.Ary,"","",a)[0],srchCntr=h.liCntrFx;if(!i){var c=h.obj.noDataTxt?h.obj.noDataTxt:"No data found in search";i='<li class="noData">'+c+"</li>",srchCntr++}h.dpLyr.find("ul").html(i),h.liCntr=srchCntr,h.max_height(),h.firstHighlight()}},h.fillDatainDropdwonLayer=function(t,e,a,i,r){h.inpElm;h.chkBox&&h.inpHid.attr({value:""}),h.srchBx===!1?($("#"+t).attr("searchDisabled",!0).find(".DDwrap").hide(),$("#"+t).find(".drop").css({position:"static"})):$("#"+t).find("div.drop").css({borderTop:0}),$("#ul_"+t).find("ul").html(e),e="",h.srchBx===!1?d():"",h.chkForParent(h.optgrpObject,h.DATA)},h.liMousehover=function(){h.id;h.dpLyr.on("mouseover","li.pickVal",function(){h.curActElm.length?"":h.firstHighlight(),h.curActElm.removeClass("active"),$(this).addClass("active"),h.curActElm=$(this)}).on("mouseout","a",function(){$(this).removeClass("active")})},h.max_height=function(){for(var t=h.id,e=$("#ul_"+t),a=0,i=$("#ul_"+t).find(" ul li:first");i.length&&h.sugHgt>=a;)a+=i.outerHeight(),i=i.next();e.css(h.sugHgt<a?{height:h.sugHgt+"px"}:{height:a+"px",width:"100%"}),e.length&&e[0].csb&&e[0].csb.reset()},h.PickValuesFromDD=function(){{var e;h.id}h.dpLyr.on("click",".pickVal a",function(a){if(h.chkBox){var i=0,r=$(this),n=r.data("id");if($(this).hasClass("chkd")&&(i=1),e=r.html(),n.split("_")[1]==h.eUnderScore(h.otherLabId))1==i?h.onClickLi(t,h.otherLabId,"unChecked"):h.onClickLi(t,h.otherLabId,"checked"),h.hideDD();else{if(1==i){var l=n;$(this).parent().attr("bindto")&&(l=n+"_"+h.Escp($(this).parent().attr("bindto"))),h.removeTag("tg_"+l,e,!0)}else{var o=$(this).parent().attr("bindto");o?n=n+"_"+h.Escp(o):"",h.CreateTags(r,n,"",h.tags)}if(h.srchBx!==!1?setTimeout(function(){h.inpElm[0].focus()},100):"",h.parentChkBox){var s=$(this).data("id").split("_"),d=s[s.length-1],c=0;if(!h.parentRefData[d]){var p=$(this).parent().prevAll("li.optgroup:first"),f=p.nextUntil(".optgroup").toArray();h.parentRefData[d]=f}for(var u in h.parentRefData[d])$(h.parentRefData[d][u]).find("a").hasClass("chkd")&&c++,c==h.parentRefData[d].length?$('li.optgroup[data-id="opt_'+d+'"]').find("a").addClass("chkd"):$('li.optgroup[data-id="opt_'+d+'"]').find("a").removeClass("chkd")}}}else h.SingleSelection($(this).text(),$(this).data("id").split("_"))})},h.SingleSelection=function(e,a){var i=a[0],r=a[2]?a[2]:"";h.inpElm?h.inpElm.val(e):"",$("#"+i).find(".cross").show();var n=h.dUnderScore(h.uEscp(a[1])).replace(h.sortPrefix,"");h.inpHid.attr({value:n}).data("optGroupKey",r),h.layerOpenStatus&&h.hideDD(),h.onClickLi(t,h.dUnderScore(h.uEscp(a[1]))),h.onChange(n)},h.CreateTags=function(e,a,i,r){var n=h.id,l=a.split("_")[1];if(r="-1"==$.inArray(l,h.preventClickFor)&&0!=r?!0:!1,h.hidValue.length<h.maxTagsCount){var o,s=h.uEscp(a).split("_"),d=a.split("_"),c=3==d.length?d[0]+"_"+d[1]:d[0]+"_"+d[1]+"_"+d[2];if("string"!=typeof e?(o=e.html(),e.addClass("chkd")):o=e,h.TagCnt++,h.obj.postPlaceholder&&h.obj.postPlaceholder.text?h.inpElm.attr("placeholder",h.obj.postPlaceholder.text):h.inpElm.attr("placeholder",""),r!==!1){o=o.replace(/(<([^>]+)>)/gi,"").replace(/&amp;/gi,"&"),h.tagwithOptGroup?o="<b>"+s[2].replace("xSlashX","/").replace(/SxP/gi," ")+"</b>("+o+")":"";var p,f=$("<li>").append('<span class="tagTxt">'+o+"</span>"),g="tg_"+a;h.tagTitle&&f.attr("title",o);var v=h.TagSpCnt;if(v||r===!1){var C=f.append($("<a>").addClass("dCross")).addClass("tagit").attr({"data-id":g}),D=$("#"+v)[0];if(h.MrgPrfAryOrdr){var m=D.children[i];m?m.parentNode.insertBefore(C[0],m):$("#"+v).append(C)}else r===!1?"":D.insertBefore(C[0],D.firstChild);h.inpElm.css({color:"#444"}),p=g+" a.dCross"}else h.MrgPrfAryOrdr?$("#"+n).find(".DDsearch li:last").before(f.append($("<span>").addClass("dCross")).addClass("tagit").attr({"data-id":g})):$("#"+n).find(".DDsearch").prepend(f.append($("<span>").addClass("dCross")).addClass("tagit").attr({"data-id":g})),h.inpElm.css({width:u+"px"}),p=g+" span.dCross";h.Fn.preserveEventafterClone(g,!0)}$("#ul_"+h.id).find('[data-id="'+c+'"]').addClass("chkd"),h.setValueInHiddenField(s[1],o),h.ChkBoxContr[s[1]]=a,h.onClickLi(t,h.dUnderScore(h.uEscp(s[1])),"Checked",$('li[data-id="tg'+a+'"]'),h.TagCnt),h.setInputText()}else h.onTagCrt("Maximum Tags Created");h.tags&&!h.TagSpCnt&&(h.inpElm.val(""),h.setLi(h.id),h.max_height())},h.setValueInHiddenField=function(t,e,a){var i=h.id;if(t&&e){"all"==e.toLowerCase()&&(h.Allflg="all"),t=h.dUnderScore(h.uEscp(t)).replace(h.sortPrefix,"");var r=h.inpHid.val();r?(h.hidValue.push(t),h.inpHid.val(JSON.stringify(h.hidValue))):(h.hidValue.push(t),h.inpHid.val(JSON.stringify(h.hidValue)),$("#clrAll_"+i).show(),h.TagSpCnt?$("#"+h.TagSpCnt).show():$("#"+i).find("li.frst").css({"float":"left"})),h.onTagCrt()}else a!==!1&&(h.inpElm.val(""),h.inpHid.val(""));h.onChange(h.hidValue)},n(),h.PickValuesFromDD(),h.liMousehover(),h.clickParent(),h.clickMain()};DD.prototype.prefillDataFormation=function(t){var e=this,a=(e.id,{});if(e.chkBox){if(t)for(var i in t)a[t[i]]="1"}else a=t;return a},DD.prototype.removeAllTags=function(){var t=this,e=t.id;for(var a in t.ChkBoxContr){var i,r=t.ChkBoxContr[a],n=r.split("_");3==n.length?i=n[0]+"_"+n[1]:4==n.length&&(i=n[0]+"_"+n[1]+"_"+n[2]),$("#ul_"+e).find('[data-id="'+i+'"]').removeClass("chkd"),t.TagSpCnt?$("#"+t.TagSpCnt).find('[data-id="tg_'+r+'"]').remove():$("#"+e).find(".DDsearch").find('[data-id="tg_'+r+'"]').remove()}t.parentChkBox&&$("#ul_"+e).find('li a[data-id="'+e+'"]').removeClass("chkd"),t.allChk&&$("#ul_"+e).find('li[data-id="opt_all"]').find("a").removeClass("chkd"),t.resetInpWidth(e),t.ChkBoxContr={},t.inpHid.val(""),t.hidValue=[],t.TagCnt=0,t.setPlaceHolderAttribute()},DD.prototype.destroy=function(){var t=this,e=t.id;t.dpLyr.remove(),t.inpHid.remove(),$("#"+e).find(".DDsearch .tagit").remove(),t.inpElm.val("").attr({placeholder:t.inpElm.data("placeholder"),name:t.inpElm.data("name")}),t.inpElm.removeAttr("autocomplete style"),t.inpElm.off("focus keydown keyup blur")},DD.prototype.removeTag=function(t,e,a,i){var r=this,n=r.id,l=t.replace("tg_",""),o=l.split("_"),s=$.parseJSON($("#hid_"+n).val()),d=4==o.length?o[0]+"_"+o[1]+"_"+o[2]:o[0]+"_"+o[1];if(-1!=$.inArray(o[1],s)){if($("#ul_"+n).find('[data-id="'+r.Escp(d)+'"]').removeClass("chkd"),r.parentChkBox){var c=d.split("_");c=c[c.length-1];for(key in r.parentRefData[c])$(r.parentRefData[c][key]).find("a").hasClass("chkd")||($("#ul_"+n).find('li[data-id="opt_'+c+'"]').find("a").removeClass("chkd"),$("#ul_"+n).find('li[data-id="opt_all"]').find("a").removeClass("chkd"))}i?$("#"+i).remove():r.TagSpCnt?$("#"+r.TagSpCnt).find('[data-id="'+t+'"]').remove():$("#"+n).find(".DDsearch").find('[data-id="'+t+'"]').remove(),r.emptyHidField(l.split("_")[1],n,e),r.TagCnt--,r.TagCnt||r.setPlaceHolderAttribute();for(var p in r.ChkBoxContr)r.ChkBoxContr[p]==l&&delete r.ChkBoxContr[p];a?r.onClickLi(r.obj,r.dUnderScore(r.uEscp(o[1])),"Unchecked","",r.TagCnt):"",r.setInputText()}},DD.prototype.fillData=function(){var t=[],e=this,a=e.id,i=e.prefillDataFormation(e.prefillData);t[a]=i;e.inpHid.val()&&e.removeAllTags(),e.NLi=e.appendData(e.Ary,t,i),e.fillDatainDropdwonLayer(a,e.NLi[0],0,e.NLi[3],e.NLi[4]),e.liCntrFx=e.liCntr=e.NLi[1],e.createTags_ifPrefillData(e.NLi[2])},DD.prototype.appendData=function(t,e,a,i){var r,n,l="",o=this,s=o.id,d=[],c="",p=0,h=0;o.allChk&&(l+=o.createParLi("all","All","0",!0));for(var f in t){n=f;for(var u in t[f]){var g=u.replace(o.sortPrefix,""),v=o.eUnderScore(o.Escp(g));if("object"==typeof t[f][u]){var C=o.parentChkBox;l+=o.createParLi(v,u,s,C);var D=[];p++;var m=[];o.optgrpObject[u]={},o.optgrpObject[u].checked=m,o.optgrpObject[u].unchecked=D;for(var k in t[f][u]){void 0!=a[k]?m.push(k):D.push(k),o.optgrpNameRef[k]={pName:u,text:t[f][u][k]};var x=o.Escp(k);if(e[s])if(e[s][k]){var y;if(parseInt(e[s][k])?y=k:"",y===k){o.inpVal=k,c=t[f][u][k];var _=f?s+"_"+x+"_"+v+"_"+f:s+"_"+x+"_"+v,T=[c,_,s,x];d[h++]=T,p++,l+=o.createLi(s+"_"+x+"_"+v,t[f][u][k],f),r=v}}else{a===k&&(o.inpVal=k,c=t[f][u][k],r=v),p++;var A=o.selCheckBox(s,v,f,x);l+=o.createLi(s+"_"+x+"_"+v,t[f][u][k],f,A)}else{a===k&&(o.inpVal=k,c=t[f][u][k]);var E=o.selCheckBox(s,v,f,x);l+=o.createLi(s+"_"+x+"_"+v,t[f][u][k],f,E),p++}}}else if(o.optgrpNameRef[u]={text:t[f][u]},o.chkBox){var b="";if(e&&!$.isEmptyObject(e[s])&&(e[s][g]?b=g:""),b==g){var S=[t[f][u],s+"_"+v+"_"+f,s,u];d[h++]=S,l+=o.createLi(s+"_"+v,t[f][u],f,""),p++}else{var L=o.selCheckBox(s,v,f);l+=o.createLi(s+"_"+v,t[f][u],f,L),p++}}else o.prefillData==g?(l+=o.createLi(s+"_"+v,t[f][u]),o.inpVal=u,c=t[f][u],p++,i?"":o.SingleSelection(t[f][u],[s,u])):(l+=o.createLi(s+"_"+v,t[f][u]),p++)}}if(!l){var B=o.obj.noDataTxt?o.obj.noDataTxt:"No data found in search";l='<li class="noData">'+B+"</li>"}if(o.chkBox&&o.tagsSorting===!1){var w=[],P=0;for(var V in a)for(var j in d)d[j][3]==V&&(w[P++]=d[j]);d=w}return $.extend(o.Ary[n],t[n]),[l,p,d,c,r]},DD.prototype.chkForParent=function(t,e){for(var a in t)0==t[a].unchecked.length?($('li[data-id="opt_'+this.eUnderScore(this.Escp(a))+'"]').find("a").addClass("chkd"),$('li[data-id="opt_all"]').find("a").addClass("chkd")):$('li[data-id="opt_all"]').find("a").removeClass("chkd")},DD.prototype.Escp=function(t){return t?t.replace(/\s/g,"SxP"):""},DD.prototype.uEscp=function(t){return t?t.replace(/SxP/g," "):!1},DD.prototype.eUnderScore=function(t){return t?t.replace(/\_/g,"undrxxscr"):""},DD.prototype.dUnderScore=function(t){return t?t.replace(/undrxxscr/gi,"_"):""},DD.prototype.clickParent=function(){var t=this,e=t.id;$("#ul_"+e).on("click","li.optgroup",function(){var t=this,e=$(this).nextUntil("li.optgroup"),a=e.length;if($(this).children("a").hasClass("chkd")){for(i=0;i<=a;i++)$(e).eq(i).find("a").hasClass("chkd")&&$(e).eq(i).find("a").click();$(t).children("a").removeClass("chkd")}else{for(i=0;i<=a;i++)$(e).eq(i).find("a").hasClass("chkd")||$(e).eq(i).find("a").click();$(t).children("a").addClass("chkd")}})},DD.prototype.clickMain=function(){var t=this,e=t.id;$("#ul_"+e).on("click",'li.optgroup[data-id="opt_all"]',function(t){t.stopImmediatePropagation();var e=this,a=$(this).siblings("li.optgroup"),i=a.length;if($(this).children("a").hasClass("chkd")){for(j=0;j<=i;j++)$(a).eq(j).find("a").hasClass("chkd")||$(a).eq(j).click();$(e).children("a").addClass("chkd")}else{for(j=0;j<=i;j++)$(a).eq(j).find("a").hasClass("chkd")&&$(a).eq(j).click();$(e).children("a").removeClass("chkd")}})},DD.prototype.searchData=function(t,e,a,i,r){var n="",l=this,t=t.toString();if(getPos=t.toLowerCase().indexOf(e.toLowerCase()),strLower=t.toLowerCase(),sTxtValueLower=e.toLowerCase(),spaceVal=strLower.indexOf(" "+sTxtValueLower)<0?!1:strLower.indexOf(" "+sTxtValueLower),bracketVal=strLower.indexOf("("+sTxtValueLower)<0?!1:strLower.indexOf("("+sTxtValueLower),slashVal=strLower.indexOf("/"+sTxtValueLower)<0?!1:strLower.indexOf("/"+sTxtValueLower),getPos>=0&&(spaceVal||bracketVal||slashVal)||0===getPos){getPos&&(spaceVal?getPos=spaceVal+1:bracketVal?getPos=bracketVal+1:slashVal&&(getPos=slashVal+1));var o=t.substr(0,getPos),s="<b>"+t.substr(getPos,e.length)+"</b>",d=t.substr(getPos+e.length,t.length),c=l.Escp(i).replace(l.sortPrefix,"");n=l.selChkBox(c+"_"+r,a)?l.createLi(c,o+s+d,r,"chkd"):l.createLi(c,o+s+d,r)}return n},DD.prototype.selChkBox=function(t,e){var a=0,i=this;for(var r in i.ChkBoxContr)t==i.ChkBoxContr[r]&&(a=1);return a?!0:!1},DD.prototype.selCheckBox=function(t,e,a,i){var r=0;for(var n in this.ChkBoxContr){r=1;break}return r?i?this.selChkBox(t+"_"+i+"_"+e+"_"+a,t)?"chkd":"":this.selChkBox(t+"_"+e+"_"+a,t)?"chkd":"":void 0},DD.prototype.createParLi=function(t,e,a,i){return i=i?'class="'+i+'"':"",i?'<li class="optgroup" data-id=opt_'+t+'><a href="javascript:;" data-id='+a+">"+e+"</li>":'<li class="optgroup" data-id=opt_'+t+">"+e+"</li>"},DD.prototype.createLi=function(t,e,a,i){return a=a?'bindTo="'+a+'"':"",i=i?'class="'+i+'"':"",'<li class="pickVal" '+a+'><a href="javascript:;" '+i+" data-id="+t+">"+this.replaceTag(e)+"</a></li>"},DD.prototype.resetInpWidth=function(t){$("#clrAll_"+t).hide(),this.inpElm.css({width:""}),$("#"+t).find("li.frst").css({"float":"none"})},DD.prototype.firstHighlight=function(){var t,e=this,a=e.id,i=$("#ul_"+a),r=i.find("ul");e.curActElm&&e.curActElm.removeClass("active"),e.curActElm=r.find("li:first-child");var n=e.Escp(e.inpHid.attr("value"));n&&!e.chkBox?(e.curActElm.removeClass("active"),t=e.inpHid.data("optGroupKey")?a+"_"+n+"_"+e.inpHid.data("optGroupKey"):a+"_"+n,e.curActElm=r.find('[data-id="'+t+'"]').parent().addClass("active")):e.curActElm.addClass("active")},DD.prototype.emptyHidField=function(t,e,a){var i=this;a&&"all"==a.toLowerCase()?i.Allflg="":"";var r,n=i.dUnderScore(i.uEscp(t)).replace(i.sortPrefix,""),l=$.inArray(n,i.hidValue);-1!==l&&(i.hidValue.splice(l,1),r=JSON.stringify(i.hidValue)),0==i.hidValue.length&&(i.resetInpWidth(e),r=i.hidValue),i.inpHid.val(r),i.onChange(i.hidValue)},DD.prototype.setInputText=function(){var t,e=this,a=e.id;t="all"==e.Allflg?"all":e.TagCnt,e.TagCnt?e.TagSpCnt||e.tags===!1?e.inpElm.val(e.preTxt+" "+t+" "+e.postTxt):"":!e.inpHid.val()&&e.inputValReset&&($("#"+a).find(".cross").hide(),e.inpElm.val(""),e.inpElm.css({width:""}))},DD.prototype.setPlaceHolderAttribute=function(){var t=this;t.inpElm.attr("placeholder",t.inpElm.data("placeholder")),t.inpElm.parents(".frst").css({"float-left":"none"})},DD.prototype.removeData=function(t){var e=this,a=(e.id,0);e.dpLyr.find("ul li").each(function(){if($(this).attr("bindTo")==t.key){var i=$(this).children("a");if(i.length){var r=i.data("id");i.hasClass("chkd")&&(delete e.ChkBoxContr[e.uEscp(r.split("_")[1])],e.removeTag("tg_"+r+"_"+e.Escp(t.key),i.html(),!0))}a++,$(this).remove()}}),delete e.Ary[t.key],e.liCntr=e.liCntr-a,$("#ul_"+e.id).find("li").length||$("#"+e.id).find(".tagit").remove()},DD.prototype.removeBlockofData=function(t){this.removeData(t)},DD.prototype.addSelected=function(t,e){var a=this.id;for(var i in t)this.CreateTags(t[i],a+"_"+i+"_A",0,e)},DD.prototype.deleteSelected=function(t){var e=this.id;for(var a in t.keyObject)this.removeTag("tg_"+e+"_"+t.keyObject[a]+"_A","",t.tag_onof_flag,t.remId)},DD.prototype.select=function(t){var e=this,a=e.id;if(e.chkBox)for(var i in t.key){var r=t.key[i],n=e.sortPrefix?e.sortPrefix+r:r,l=e.optgrpNameRef[n];l.pName?e.CreateTags(l.text,a+"_"+r+"_"+l.pName+"_A"):e.CreateTags(l.text,a+"_"+r+"_A")}else{if(!e.optgrpNameRef[t.key])throw"DD: Key not exist";e.SingleSelection(e.optgrpNameRef[t.key].text,[a,t.key])}},DD.prototype.deselect=function(t){var e=this,a=e.id;if(e.chkBox)for(var i in t.key){var r=t.key[i],n=e.sortPrefix?e.sortPrefix+r:r,l=e.optgrpNameRef[n];e.removeTag(l.pName?"tg_"+a+"_"+t.key[i]+"_"+l.pName+"_A":"tg_"+a+"_"+t.key[i]+"_A")}else{if(!e.optgrpNameRef[t.key])throw"DD: Key not exist";e.SingleSelection("",[a])}},DD.prototype.addData=function(t){var e=this,a={},i=[];t.status||(t.status="Checked");var r=t.key?t.key:"A";if("Checked"==t.status){a[r]=t.data;var n=e.prefillDataFormation(t.prefillData);i[e.id]=n,e.NLi=e.appendData(a,i,n),$("#ul_"+e.id).find("ul").append(e.NLi[0]),e.createTags_ifPrefillData(e.NLi[2]),e.liCntr+=e.NLi[1]}else"Unchecked"==t.status&&this.removeBlockofData(t)},DD.prototype.createTags_ifPrefillData=function(t){{var e=this;e.id}if(e.chkBox&&t)for(var a=0;a<t.length;a++){for(var i in e.prefillData)if(e.prefillData[i]==t[a][3])break;e.CreateTags(t[a][0],t[a][1],i,e.tags)}e.setInputText()},DD.prototype.replaceData=function(t){var e=this;id=e.id;var a=t.isReset===!1?t.isReset:e.isReset,i=[],r=e.inpHid,n=$.trim(r.val());e.prefillData=t.prefillData;if(e.chkBox&&n&&(e.TagSpCnt?$("#"+e.TagSpCnt).find(".tagit").remove():$("#"+id).find(".DDsearch").find(".tagit").remove(),e.resetInpWidth(id),e.ChkBoxContr={},r.val(""),e.hidValue=[],e.TagCnt=0,e.setPlaceHolderAttribute()),a&&(e.inpElm.val(""),r.val("")),$.isEmptyObject(t.data))throw"Either data object is empty or undefined";e.Ary={A:t.data},e.ChkBoxContr=[];var l=e.prefillDataFormation(t.prefillData);i[id]=l;var o=e.appendData(e.Ary,i,l);e.dpLyr.find("ul").html(o[0]),e.createTags_ifPrefillData(o[2]),e.liCntr=o[1]},DD.prototype.hideDD=function(){var t=this,e=t.id;"block"==t.dpLyr.css("display")&&(t.dpLyr.hide(),$("#"+e).find(".DDwrap").removeClass("brBotN"),t.chkBox||(t.curActElm?t.curActElm.removeClass("active"):"",!t.inpHid.val()&&t.inputValReset&&t.inpElm.val("")),t.setInputText()),t.srchBx!==!1&&t.setLi(e)},DD.Ary={},DD.lastRef={};